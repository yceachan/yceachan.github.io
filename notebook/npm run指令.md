# WikiExplorer npm run 指令详解

在 `WikiExplorer` 项目中，三个核心指令分工明确，形成了“数据准备 -> 开发调试 -> 生产发布”的工作流。

## 1. `npm run sync` (数据同步/索引生成)
*   **核心目标**：准备数据。
*   **执行逻辑**：运行 `scripts/sync-notes.js` 脚本。
*   **具体过程**：
    1.  扫描配置在 `SOURCE_DIRS` 中的 Workspace 目录。
    2.  根据 Pages 工程根目录下的 `.gitignore` 规则过滤敏感文件。
    3.  复制 Profile 头像和配置 (`profile.json`)。
    4.  将有效 `.md` 文件“搬运”到 `public/notes/`。
    5.  生成包含目录结构和修改时间的 `public/directory-tree.json` 索引文件。
*   **使用场景**：当你修改了外部笔记内容、新增了文件夹、或者想更新侧边栏索引时执行。

## 2. `npm run dev` (本地开发模式)
*   **核心目标**：开发代码 (UI/逻辑)。
*   **执行逻辑**：启动 Vite 开发服务器。
*   **具体过程**：
    1.  加载 `src/` 下的 React 代码。
    2.  提供 **热更新 (HMR)**：修改 React 组件或 CSS 后浏览器自动刷新。
*   **使用场景**：调整网页 UI 布局、修改侧边栏样式或开发新功能时。
*   **注意**：此指令**不会**自动触发 `sync`。若笔记数据未更新，需手动先运行 `npm run sync`。

## 3. `npm run build` (生产打包)
*   **核心目标**：发布产物。
*   **执行逻辑**：`npm run sync && vite build`。
*   **具体过程**：
    1.  **自动执行 Sync**：确保打包时拥有最新的笔记数据。
    2.  **Vite 打包**：编译 React 代码、压缩混淆 CSS/JS、处理静态资源。
    3.  **输出**：将所有最终产物生成到 `dist/` 文件夹。
*   **使用场景**：准备将项目发布到 GitHub Pages 或其他静态服务器时。

## 总结对比表

| 指令 | 核心目标 | 关注点 | 产物位置 |
| :--- | :--- | :--- | :--- |
| `npm run sync` | **准备数据** | 笔记文件、目录结构 | `public/notes/` |
| `npm run dev` | **开发代码** | UI 交互、样式、逻辑 | 内存 (本地服务器) |
| `npm run build` | **发布产物** | 性能、兼容性、最新数据 | `dist/` |
