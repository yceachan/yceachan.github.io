# SVN 稀疏检出实操笔记（TortoiseSVN GUI 版）
## 核心适用场景
适用于仅需检出**目录层级结构**、无需检出文件/深层内容的场景（如PCB项目仓库按年份/项目号分层管理，仅需空目录结构便于后续按需检出），核心利用TortoiseSVN的**粘滞深度（Sticky Depth）**和**自定义项目选择**实现精准稀疏检出。

## 一、TortoiseSVN GUI 核心检出深度选项
检出深度在「检出」「更新到修订版本」对话框中选择，决定仓库内容的获取范围，**非全递归选项会自动生成粘滞深度**，后续更新将遵循该深度，避免意外下载文件/深层目录。

| 中文选项               | 英文选项                          | 核心作用                                                                 | 适用场景                     |
|------------------------|-----------------------------------|--------------------------------------------------------------------------|------------------------------|
| 全递归                 | Fully recursive                   | 检出/更新所有层级的目录+文件，无深度限制                                 | 需完整获取单个项目所有内容时 |
| 直接子节点，包含文件夹 | Immediate children, including folders | 检出当前目录，包含其下**所有一级子目录（空文件夹）+ 自身文件**，不递归子目录 | 生成目录层级（如一级→二级空目录） |
| 仅文件子节点           | Only file children                | 仅检出当前目录的文件，不检出任何子目录                                   | 仅需根目录文件，无需子目录时 |
| **仅此项**             | **Only this item**                | 仅创建当前目录本身，**无文件、无子目录**（纯空目录）| 初始化根仓库/仅需单个空目录 |
| 工作副本               | Working copy                      | 保持当前工作副本已设置的粘滞深度，不修改                                 | 常规更新，保留原有深度设置   |
| 排除                   | Exclude                           | 从工作副本中排除指定目录/文件，后续不再检出/更新                         | 剔除无需的目录层级           |

**关键重点**：实现「仅空目录层级」的核心选项为**仅此项**（初始化根目录）和**直接子节点，包含文件夹**（生成下级目录层级）。

## 二、「根仓库仅检出+自定义项目更新」稀疏检出 Best Practice
### 核心逻辑
先以「仅此项」检出**根仓库纯空目录**（最小化初始化），再通过「更新到修订版本→自定义项目选择」，精准勾选需要的目录层级，一次性生成目标空目录结构，**替代逐层手动更新，效率最高**，完全匹配分层仓库的检出需求。

### 实操步骤（以PCB仓库为例：`PCB → 2025-PCB → 项目子目录`）
#### 步骤1：初始化根仓库（仅检出纯空根目录）
1. 本地新建目标文件夹（如`D:\Workspace\SVN\PCB`），右键该文件夹 → **TortoiseSVN → 检出...**；
2. 「URL of repository」输入**根仓库完整URL**（如`https://47.102.118.39/svn/SoYeah_HW/PCB`）；
3. 「Checkout depth」选择**仅此项**；
4. 勾选底部**省略外部（Omit externals）**（避免检出无关外部引用，必勾）；
5. 点击「确定」，输入SVN账号密码，完成后本地仅生成**空的PCB根目录**（含隐藏`.svn`，为SVN工作副本）。

#### 步骤2：自定义项目选择，检出目标目录层级
1. 进入本地根仓库（如`PCB`目录），右键**空白处** → **TortoiseSVN → 更新到修订版本...**（关键：右键空白处，而非文件夹）；
2. 弹窗中「Update depth」下拉菜单选择 **选择项目...（Choose items...）**，进入自定义勾选界面；
3. 左侧目录树按仓库实际结构**展开层级**（如`PCB → 2025-PCB → 2025-050-YC1011SB_YJX_mouse_V1.0`）；
4. **仅勾选需要的目录节点**，**取消所有文件的勾选**（确保仅生成空目录，无文件）；
   - 勾选父目录会自动关联子目录，可手动取消无需的子目录；
   - 如需生成「一级→二级→三级」空目录，依次勾选对应目录即可；
5. 保持底部**省略外部**勾选，点击「确定」，SVN会自动按勾选层级生成**纯空目录结构**，并为所有目录设置对应粘滞深度。

#### 步骤3：验证检出结果
1. 本地查看目录：仅存在勾选的层级目录，无任何文件；
2. 右键任意生成的子目录 → **TortoiseSVN → 属性**，查看`svn:depth`属性，应为`empty`（仅此项）或`immediates`（直接子节点）；
3. PowerShell验证目录树：执行`tree 本地根路径 /A | Select-Object -First N`，确认层级与勾选一致。

### 三、关键注意事项
1. **粘滞深度自动生效**：自定义项目更新后，所有目录的粘滞深度自动生成，后续普通「更新」操作不会下载文件/深层内容，仅保留空目录；
2. **按需修改单个目录深度**：若后续需要检出某项目的完整内容，右键该项目目录 → **更新到修订版本...**，深度选择**全递归**，即可单独更新该目录的所有文件/子目录，不影响其他目录；
3. **省略外部必勾**：大型仓库通常包含`svn:externals`外部引用（如公共库、依赖），勾选后可避免无关内容占用磁盘，加速检出；
4. **避免全递归**：稀疏检出的核心是「按需获取」，切勿在根仓库选择「全递归」，否则会下载整个仓库的所有内容；
5. **URL匹配校验**：若更新时提示「URL不匹配」，勾选弹窗中的**强制更新（Force）**，可强制本地目录与远程仓库URL关联。

## 四、快速修改/扩展目录层级
1. **添加新层级**：重复「步骤2」，在自定义项目选择界面勾选新增的目录节点，点击更新即可；
2. **排除已有目录**：右键需排除的目录 → **更新到修订版本...**，深度选择**排除**，点击确定后该目录会被标记为排除，后续更新不再同步；
3. **重置深度**：若需恢复某目录的默认检出规则，右键该目录 → **更新到修订版本...**，深度选择**工作副本**，即可继承父目录的粘滞深度。