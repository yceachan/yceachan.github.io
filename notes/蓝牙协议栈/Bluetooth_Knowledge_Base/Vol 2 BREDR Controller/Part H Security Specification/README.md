# Part H: Security Specification

**Start Page:** 1021

## Table of Contents

- 1 Security overview (Page 1024)
  - 1.1 Pausing encryption and role switch (Page 1025)
  - 1.2 Change connection link keys (Page 1025)
  - 1.3 Periodically refreshing encryption keys (Page 1026)
- 2 Random number generation (Page 1027)
- 3 Key management (Page 1029)
  - 3.1 Key types (Page 1029)
  - 3.2 Key generation and initialization (Page 1031)
    - 3.2.1 Generation of initialization key, Kinit (Page 1031)
    - 3.2.2 Authentication (Page 1032)
    - 3.2.3 [This section is no longer used] (Page 1032)
    - 3.2.4 Generation of a combination key (Page 1032)
    - 3.2.5 Generating the encryption key (Page 1034)
    - 3.2.6 Point-to-multipoint configuration (Page 1034)
    - 3.2.7 Modifying the link keys (Page 1035)
    - 3.2.8 Generating a temporary link key (Page 1035)
- 4 Encryption (E0) (Page 1037)
  - 4.1 Encryption key size negotiation (Page 1037)
  - 4.2 Encryption of broadcast messages (Page 1038)
  - 4.3 Encryption concept (Page 1038)
  - 4.4 Encryption algorithm (Page 1039)
    - 4.4.1 The operation of the cipher (Page 1041)
  - 4.5 LFSR initialization (Page 1042)
  - 4.6 Key stream sequence (Page 1045)
- 5 Authentication (Page 1046)
  - 5.1 Repeated attempts (Page 1049)
- 6 The authentication and key-generating functions (Page 1050)
  - 6.1 The authentication function E1 (Page 1050)
  - 6.2 The functions Ar and A’r (Page 1052)
    - 6.2.1 The round computations (Page 1053)
    - 6.2.2 The substitution boxes “e” and “l” (Page 1053)
    - 6.2.3 Key scheduling (Page 1055)
  - 6.3 E2-key generation function for authentication (Page 1055)
  - 6.4 E3-key generation function for encryption (Page 1057)
- 7 Secure Simple Pairing (Page 1059)
  - 7.1 Phase 1: Public key exchange (Page 1060)
  - 7.2 Phase 2: Authentication stage 1 (Page 1061)
    - 7.2.1 Authentication stage 1: Numeric Comparison protocol (Page 1061)
    - 7.2.2 Authentication stage 1: Out of Band protocol (Page 1063)
    - 7.2.3 Authentication stage 1: Passkey Entry protocol (Page 1065)
  - 7.3 Phase 3: Authentication stage 2 (Page 1067)
  - 7.4 Phase 4: Link key calculation (Page 1068)
  - 7.5 Phase 5: LMP authentication and encryption (Page 1069)
  - 7.6 Elliptic curve definition (Page 1069)
  - 7.7 Cryptographic function definitions (Page 1070)
    - 7.7.1 The Secure Simple Pairing commitment function f1 (Page 1070)
    - 7.7.2 The Secure Simple Pairing numeric verification function g (Page 1071)
    - 7.7.3 The Secure Simple Pairing key derivation function f2 (Page 1072)
    - 7.7.4 The Secure Simple Pairing check function f3 (Page 1073)
    - 7.7.5 [This section is no longer used] (Page 1074)
    - 7.7.6 The AES encryption key generation function h3 (Page 1074)
    - 7.7.7 The Device authentication key generation function h4 (Page 1075)
    - 7.7.8 The Device authentication confirmation function h5 (Page 1075)
- 8 [This section is no longer used] (Page 1077)
- 9 AES-CCM encryption for BR/EDR (Page 1078)
  - 9.1 Nonce formats (Page 1078)
  - 9.2 Counter mode blocks (Page 1080)
  - 9.3 Encryption blocks (Page 1081)
  - 9.4 Encryption key size reduction (Page 1082)
  - 9.5 Repeated MIC failures (Page 1082)
