# Part C: Link Manager Protocol Specification

**Start Page:** 631

## Table of Contents

- 1 Introduction (Page 636)
- 2 General rules (Page 637)
  - 2.1 Message transport (Page 637)
  - 2.2 Synchronization (Page 637)
  - 2.3 Packet format (Page 638)
  - 2.4 Transactions (Page 639)
    - 2.4.1 LMP response timeout (Page 639)
  - 2.5 Error handling (Page 640)
    - 2.5.1 Transaction collision resolution (Page 641)
  - 2.6 Procedure rules (Page 641)
  - 2.7 General response messages (Page 642)
  - 2.8 LMP message constraints (Page 642)
- 3 Device features (Page 643)
  - 3.1 General description (Page 643)
  - 3.2 Feature definitions (Page 643)
  - 3.3 Feature mask definition (Page 648)
  - 3.4 Link Manager interoperability policy (Page 651)
  - 3.5 Feature requirements (Page 651)
    - 3.5.1 [This section is no longer used] (Page 654)
    - 3.5.2 [This section is no longer used] (Page 654)
- 4 Procedure rules (Page 655)
  - 4.1 Connection control (Page 655)
    - 4.1.1 Connection establishment (Page 655)
    - 4.1.2 Detach (Page 656)
    - 4.1.3 Power control (Page 657)
      - 4.1.3.1 Enhanced power control (Page 659)
        - 4.1.3.1.1 Sending enhanced power control requests (Page 659)
        - 4.1.3.1.2 Responding to enhanced power control requests (Page 659)
    - 4.1.4 Adaptive frequency hopping (Page 660)
      - 4.1.4.1 Central enables AFH (Page 661)
      - 4.1.4.2 Central disables AFH (Page 662)
      - 4.1.4.3 Central updates AFH (Page 662)
      - 4.1.4.4 AFH operation in Hold and Sniff modes (Page 663)
    - 4.1.5 Channel classification (Page 663)
      - 4.1.5.1 Channel classification reporting enabling and disabling (Page 665)
    - 4.1.6 Link supervision (Page 665)
    - 4.1.7 Channel quality driven data rate change (CQDDR) (Page 666)
    - 4.1.8 Quality of service (QoS) (Page 667)
      - 4.1.8.1 Central notifies Peripheral of the quality of service (Page 667)
      - 4.1.8.2 Device requests new quality of service (Page 668)
    - 4.1.9 Paging scheme parameters (Page 668)
      - 4.1.9.1 Page mode (Page 669)
      - 4.1.9.2 Page Scan mode (Page 669)
    - 4.1.10 Control of multi-slot packets (Page 670)
    - 4.1.11 Enhanced Data Rate (Page 671)
    - 4.1.12 Encapsulated LMP PDUs (Page 672)
      - 4.1.12.1 Sending an encapsulated PDU (Page 672)
    - 4.1.13 Ping (Page 673)
    - 4.1.14 Piconet clock adjustment (Page 674)
      - 4.1.14.1 Central coarse adjustment of piconet clock (Page 675)
      - 4.1.14.2 Peripheral request for coarse adjustment of piconet clock (Page 677)
    - 4.1.15 Slot Availability Mask (Page 678)
      - 4.1.15.1 SAM type 0 submap configuration (Page 680)
      - 4.1.15.2 SAM slot map define (Page 681)
      - 4.1.15.3 SAM switch sequence (Page 681)
      - 4.1.15.4 SAM change during the transmission of a multi-slot packet (Page 682)
      - 4.1.15.5 SAM and role switching (Page 682)
      - 4.1.15.6 SAM and Sniff mode (Page 682)
  - 4.2 Security (Page 682)
    - 4.2.1 Authentication (Page 683)
      - 4.2.1.1 Claimant has link key (legacy authentication) (Page 683)
      - 4.2.1.2 Claimant has no link key (legacy authentication and secure authentication) (Page 684)
      - 4.2.1.3 Repeated attempts (Page 684)
      - 4.2.1.4 Responder has link key (secure authentication) (Page 685)
    - 4.2.2 Pairing (Page 686)
      - 4.2.2.1 Responder accepts pairing and has a variable PIN (Page 686)
      - 4.2.2.2 Responder accepts pairing and has a fixed PIN (Page 687)
      - 4.2.2.3 Responder rejects pairing (Page 687)
      - 4.2.2.4 Creation of the link key (Page 688)
      - 4.2.2.5 Repeated attempts (Page 689)
    - 4.2.3 Change link key (Page 689)
    - 4.2.4 Change current link key type (Page 690)
      - 4.2.4.1 Change to a temporary link key (Page 690)
      - 4.2.4.2 Semi-permanent link key becomes current link key (Page 691)
    - 4.2.5 Encryption (Page 691)
      - 4.2.5.1 Encryption mode (Page 692)
      - 4.2.5.2 Encryption key size (Page 693)
      - 4.2.5.3 Start encryption (Page 695)
      - 4.2.5.4 Stop encryption (Page 696)
      - 4.2.5.5 Pause encryption (Page 697)
      - 4.2.5.6 Resume encryption (Page 699)
      - 4.2.5.7 Change encryption key or random number (Page 700)
      - 4.2.5.8 Encryption key refresh (Page 701)
    - 4.2.6 Request supported encryption key size (Page 701)
    - 4.2.7 Secure Simple Pairing (Page 702)
      - 4.2.7.1 IO capability exchange (Page 703)
        - 4.2.7.1.1 IO capability exchange transaction collision and resolution (Page 704)
      - 4.2.7.2 Public key exchange (Page 704)
      - 4.2.7.3 Authentication stage 1 (Page 705)
        - 4.2.7.3.1 Authentication stage 1: Numeric Comparison (Page 706)
          - 4.2.7.3.1.1 Commitment check failure (Page 706)
          - 4.2.7.3.1.2 Numeric Comparison failure on Initiator side (Page 707)
          - 4.2.7.3.1.3 Numeric Comparison failure on Responder side (Page 707)
        - 4.2.7.3.2 Authentication stage 1: Passkey Entry Authentication (Page 708)
          - 4.2.7.3.2.1 Commitment check failure on the Responder side (Page 709)
          - 4.2.7.3.2.2 Commitment check failure on the Initiator side (Page 709)
          - 4.2.7.3.2.3 Passkey Entry failure on Initiator side (Page 710)
        - 4.2.7.3.3 Passkey Entry failure on Responding side (Page 710)
        - 4.2.7.3.4 Keypress notifications (Page 711)
        - 4.2.7.3.5 Authentication stage 1: OOB (Page 711)
          - 4.2.7.3.5.1 Commitment check failure on the Responder side (Page 712)
          - 4.2.7.3.5.2 Commitment check failure on the Initiator side (Page 712)
        - 4.2.7.3.6 Out-of-band information not available on the Initiator side (Page 713)
      - 4.2.7.4 Authentication stage 2: DHKey check (Page 713)
        - 4.2.7.4.1 Check failure (Page 714)
          - 4.2.7.4.1.1 [This section is no longer used] (Page 715)
  - 4.3 Informational requests (Page 715)
    - 4.3.1 Timing accuracy (Page 715)
    - 4.3.2 Clock offset (Page 716)
    - 4.3.3 LMP version (Page 717)
    - 4.3.4 Supported features (Page 718)
    - 4.3.5 Name request (Page 719)
  - 4.4 Role switch (Page 720)
    - 4.4.1 Slot offset (Page 720)
    - 4.4.2 Role switch (Page 721)
  - 4.5 Modes of operation (Page 724)
    - 4.5.1 Hold mode (Page 724)
      - 4.5.1.1 Central forces Hold mode (Page 724)
      - 4.5.1.2 Peripheral forces Hold mode (Page 725)
      - 4.5.1.3 Central or Peripheral requests Hold mode (Page 725)
    - 4.5.2 [This section is no longer used] (Page 726)
    - 4.5.3 Sniff mode (Page 726)
      - 4.5.3.1 Central or Peripheral requests Sniff mode (Page 727)
      - 4.5.3.2 Moving a Peripheral from Sniff mode to Active mode (Page 728)
      - 4.5.3.3 Sniff subrating (Page 729)
  - 4.6 Logical transports (Page 730)
    - 4.6.1 SCO logical transport (Page 730)
      - 4.6.1.1 Central initiates a SCO link (Page 731)
      - 4.6.1.2 Peripheral initiates a SCO link (Page 732)
      - 4.6.1.3 Central requests change of SCO parameters (Page 733)
      - 4.6.1.4 Peripheral requests change of SCO parameters (Page 733)
      - 4.6.1.5 Remove a SCO link (Page 733)
    - 4.6.2 eSCO logical transport (Page 733)
      - 4.6.2.1 Central initiates an eSCO link (Page 734)
      - 4.6.2.2 Peripheral initiates an eSCO link (Page 735)
      - 4.6.2.3 Central or Peripheral requests change of eSCO parameters (Page 736)
      - 4.6.2.4 Remove an eSCO link (Page 736)
      - 4.6.2.5 Rules for the LMP negotiation and renegotiation (Page 737)
      - 4.6.2.6 Negotiation state definitions (Page 738)
  - 4.7 Test mode (Page 738)
    - 4.7.1 Activation and deactivation of Test mode (Page 738)
    - 4.7.2 Control of Test mode (Page 739)
    - 4.7.3 Summary of Test mode PDUs (Page 740)
- 5 Summary (Page 743)
  - 5.1 PDU summary (Page 743)
  - 5.2 Parameter definitions (Page 751)
  - 5.3 LMP encapsulated (Page 762)
  - 5.4 Default values (Page 762)
- Appendix A  Changes to parameter names (Page 764)
