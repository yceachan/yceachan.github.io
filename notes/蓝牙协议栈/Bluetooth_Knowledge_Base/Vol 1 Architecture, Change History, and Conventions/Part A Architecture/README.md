# Part A: Architecture

**Start Page:** 222

## Table of Contents

- 1 General description (Page 228)
  - 1.1 Overview of BR/EDR operation (Page 229)
  - 1.2 Overview of Bluetooth Low Energy operation (Page 231)
  - 1.3 [This section is no longer used] (Page 237)
  - 1.4 Nomenclature (Page 237)
- 2 Core system architecture (Page 244)
  - 2.1 Core architectural blocks (Page 247)
    - 2.1.1 Host architectural blocks (Page 248)
      - 2.1.1.1 Channel manager (Page 248)
      - 2.1.1.2 L2CAP resource manager (Page 248)
      - 2.1.1.3 Security Manager Protocol (Page 248)
      - 2.1.1.4 Attribute Protocol (Page 249)
      - 2.1.1.5 [This section is no longer used] (Page 249)
      - 2.1.1.6 Generic Attribute Profile (Page 249)
      - 2.1.1.7 Generic Access Profile (Page 249)
      - 2.1.1.8 Service Discovery Protocol (Page 249)
    - 2.1.2 BR/EDR/LE Controller architectural blocks (Page 249)
      - 2.1.2.1 Device manager (Page 249)
      - 2.1.2.2 Link manager (Page 250)
      - 2.1.2.3 Baseband resource manager (Page 250)
      - 2.1.2.4 Link Controller (Page 251)
      - 2.1.2.5 PHY (Page 251)
      - 2.1.2.6 Isochronous Adaptation Layer (Page 251)
      - 2.1.2.7 Channel Sounding (Page 251)
    - 2.1.3 [This section is no longer used] (Page 252)
- 3 Transport architecture (Page 253)
  - 3.1 Core traffic bearers (Page 253)
    - 3.1.1 Framed data traffic (Page 255)
    - 3.1.2 Unframed data traffic (Page 256)
    - 3.1.3 Reliability of traffic bearers (Page 257)
      - 3.1.3.1 BR/EDR reliability (Page 257)
      - 3.1.3.2 LE reliability (Page 258)
      - 3.1.3.3 [This section is no longer used] (Page 259)
  - 3.2 Transport architecture entities (Page 259)
    - 3.2.1 BR/EDR generic packet structure (Page 259)
    - 3.2.2 LE generic packet structure (Page 261)
    - 3.2.3 LE Channel Sounding generic packet structure and signaling format (Page 265)
  - 3.3 Physical channels (Page 266)
    - 3.3.1 BR/EDR physical channels (Page 267)
      - 3.3.1.1 Basic piconet channel (Page 267)
        - 3.3.1.1.1 Overview (Page 267)
        - 3.3.1.1.2 Characteristics (Page 268)
        - 3.3.1.1.3 Topology (Page 268)
        - 3.3.1.1.4 Supported layers (Page 269)
      - 3.3.1.2 Adapted piconet channel (Page 269)
        - 3.3.1.2.1 Overview (Page 269)
      - 3.3.1.3 Inquiry scan channel (Page 269)
        - 3.3.1.3.1 Overview (Page 269)
        - 3.3.1.3.2 Characteristics (Page 269)
        - 3.3.1.3.3 Topology (Page 270)
        - 3.3.1.3.4 Supported layers (Page 270)
      - 3.3.1.4 Page scan channel (Page 270)
        - 3.3.1.4.1 Overview (Page 270)
        - 3.3.1.4.2 Characteristics (Page 271)
        - 3.3.1.4.3 Topology (Page 271)
        - 3.3.1.4.4 Supported layers (Page 271)
      - 3.3.1.5 Synchronization scan channel (Page 272)
        - 3.3.1.5.1 Overview (Page 272)
        - 3.3.1.5.2 Characteristics (Page 272)
        - 3.3.1.5.3 Topology (Page 272)
        - 3.3.1.5.4 Supported layers (Page 272)
    - 3.3.2 LE physical channels (Page 272)
      - 3.3.2.1 LE piconet physical channel (Page 273)
        - 3.3.2.1.1 Overview (Page 273)
        - 3.3.2.1.2 Characteristics (Page 273)
        - 3.3.2.1.3 Topology (Page 274)
        - 3.3.2.1.4 Supported layers (Page 274)
      - 3.3.2.2 Advertising physical channels (Page 275)
        - 3.3.2.2.1 Overview (Page 275)
        - 3.3.2.2.2 Characteristics (Page 275)
        - 3.3.2.2.3 Topology (Page 276)
      - 3.3.2.3 Periodic physical channel (Page 276)
        - 3.3.2.3.1 Overview (Page 276)
        - 3.3.2.3.2 Characteristics (Page 276)
        - 3.3.2.3.3 Topology (Page 277)
      - 3.3.2.4 LE Isochronous physical channel (Page 277)
        - 3.3.2.4.1 Overview (Page 277)
        - 3.3.2.4.2 Characteristics (Page 277)
        - 3.3.2.4.3 Topology (Page 278)
      - 3.3.2.5 LE Channel Sounding physical channel (Page 279)
        - 3.3.2.5.1 Overview (Page 279)
        - 3.3.2.5.2 Characteristics (Page 279)
        - 3.3.2.5.3 Topology (Page 279)
    - 3.3.3 [This section is no longer used] (Page 280)
  - 3.4 Physical links (Page 280)
    - 3.4.1 BR/EDR links supported by the basic and adapted piconet physical channels (Page 281)
      - 3.4.1.1 Active physical link (Page 281)
      - 3.4.1.2 [This section is no longer used] (Page 281)
      - 3.4.1.3 Connectionless Peripheral Broadcast physical link (Page 281)
    - 3.4.2 BR/EDR links supported by the scanning physical channels (Page 282)
    - 3.4.3 LE links supported by the LE physical channels (Page 282)
      - 3.4.3.1 Active physical link (Page 282)
      - 3.4.3.2 Advertising physical link (Page 283)
      - 3.4.3.3 Periodic physical link (Page 283)
      - 3.4.3.4 Isochronous physical links (Page 283)
      - 3.4.3.5 Channel Sounding physical link (Page 283)
    - 3.4.4 [This section is no longer used] (Page 284)
  - 3.5 Logical links and logical transports (Page 284)
    - 3.5.1 Casting (Page 286)
    - 3.5.2 Scheduling and acknowledgment scheme (Page 286)
    - 3.5.3 Class of data (Page 287)
    - 3.5.4 Logical transports (Page 288)
      - 3.5.4.1 BR/EDR asynchronous connection-oriented (ACL) (Page 288)
      - 3.5.4.2 BR/EDR synchronous connection-oriented (SCO) (Page 288)
      - 3.5.4.3 BR/EDR extended synchronous connection-oriented (eSCO) (Page 289)
      - 3.5.4.4 BR/EDR active Peripheral broadcast (APB) (Page 289)
      - 3.5.4.5 [This section is no longer used] (Page 290)
      - 3.5.4.6 LE asynchronous connection (LE ACL) (Page 290)
      - 3.5.4.7 LE advertising broadcast (ADVB) (Page 292)
      - 3.5.4.8 Connectionless Peripheral Broadcast (CPB) (Page 292)
      - 3.5.4.9 LE periodic advertising (Page 293)
        - 3.5.4.9.1 LE periodic advertising broadcast (PADVB) (Page 293)
        - 3.5.4.9.2 Periodic advertising with responses (PAwR) (Page 293)
      - 3.5.4.10 Connected Isochronous Stream (CIS) (Page 294)
      - 3.5.4.11 Connected Isochronous Group (CIG) (Page 294)
      - 3.5.4.12 Broadcast Isochronous Stream (BIS) (Page 294)
      - 3.5.4.13 Broadcast Isochronous Group (BIG) (Page 295)
    - 3.5.5 Logical links (Page 295)
      - 3.5.5.1 BR/EDR logical links (Page 295)
        - 3.5.5.1.1 ACL control logical links (ACL‑C and APB‑C) (Page 295)
        - 3.5.5.1.2 User asynchronous/isochronous logical links (ACL-U and APB-U) (Page 296)
        - 3.5.5.1.3 User synchronous/extended synchronous logical links (SCO‑S/eSCO‑S) (Page 296)
        - 3.5.5.1.4 Profile Broadcast Data (PBD) logical link (Page 296)
      - 3.5.5.2 LE logical links (Page 296)
        - 3.5.5.2.1 Control logical link (LE-C) (Page 297)
        - 3.5.5.2.2 User asynchronous logical link (LE-U) (Page 297)
        - 3.5.5.2.3 Advertising Broadcast Control logical link (ADVB-C) (Page 297)
        - 3.5.5.2.4 Advertising Broadcast User Data logical link (ADVB-U) (Page 297)
        - 3.5.5.2.5 Low Energy Stream (LE-S) (Page 297)
        - 3.5.5.2.6 Low Energy Framed (LE-F) (Page 297)
        - 3.5.5.2.7 Low Energy Broadcast Control (LEB-C) (Page 298)
      - 3.5.5.3 [This section is no longer used] (Page 298)
  - 3.6 L2CAP channels (Page 298)
  - 3.7 Isochronous Adaptation Layer (ISOAL) (Page 299)
  - 3.8 Power control (Page 299)
    - 3.8.1 Power control in BR/EDR (Page 299)
    - 3.8.2 Power control in LE (Page 299)
- 4 Communication topology and operation (Page 300)
  - 4.1 Piconet topology (Page 300)
    - 4.1.1 BR/EDR topology (Page 300)
    - 4.1.2 LE topology (Page 303)
  - 4.2 Operational procedures and modes (Page 305)
    - 4.2.1 BR/EDR procedures (Page 305)
      - 4.2.1.1 Inquiry (discovering) procedure (Page 305)
        - 4.2.1.1.1 Extended Inquiry response (Page 305)
      - 4.2.1.2 Paging (connecting) procedure (Page 306)
      - 4.2.1.3 Connected mode (Page 306)
      - 4.2.1.4 Hold mode (Page 307)
      - 4.2.1.5 Sniff mode (Page 307)
      - 4.2.1.6 [This section is no longer used] (Page 307)
      - 4.2.1.7 Role switch procedure (Page 307)
      - 4.2.1.8 Enhanced Data Rate (Page 308)
      - 4.2.1.9 Connectionless Peripheral Broadcast mode (Page 308)
    - 4.2.2 LE procedures (Page 309)
      - 4.2.2.1 Device filtering procedure (Page 309)
      - 4.2.2.2 Advertising procedure (Page 309)
      - 4.2.2.3 Scanning procedure (Page 310)
      - 4.2.2.4 Discovering procedure (Page 311)
      - 4.2.2.5 Connecting procedure (Page 311)
      - 4.2.2.6 Connected mode (Page 312)
        - 4.2.2.6.1 Connection Subrating (Page 312)
      - 4.2.2.7 Periodic advertising procedure (Page 313)
      - 4.2.2.8 Periodic advertising synchronization procedure (Page 313)
      - 4.2.2.9 Periodic advertising synchronized mode (Page 314)
      - 4.2.2.10 Decision-based scanning (Page 314)
    - 4.2.3 [This section is no longer used] (Page 314)
- 5 Security overview (Page 315)
  - 5.1 Security architecture (Page 315)
  - 5.2 BR/EDR Secure Simple Pairing (Page 317)
    - 5.2.1 Security goals (Page 318)
    - 5.2.2 Passive eavesdropping protection (Page 318)
    - 5.2.3 Man-in-the-middle protection (Page 319)
    - 5.2.4 Association models (Page 319)
      - 5.2.4.1 Numeric Comparison (Page 320)
      - 5.2.4.2 Just Works (Page 320)
      - 5.2.4.3 Out of Band (Page 320)
      - 5.2.4.4 Passkey Entry (Page 321)
      - 5.2.4.5 Association model overview (Page 322)
  - 5.3 Secure Connections Only mode (Page 322)
  - 5.4 LE security (Page 323)
    - 5.4.1 Association models (Page 323)
    - 5.4.2 Key generation (Page 323)
    - 5.4.3 Encryption (Page 323)
    - 5.4.4 Signed Data (Page 324)
    - 5.4.5 Privacy feature (Page 324)
    - 5.4.6 Encrypted Advertising Data (Page 325)
  - 5.5 [This section is no longer used] (Page 326)
  - 5.6 Key generation between BR/EDR and LE physical transports (Page 326)
- 6 Bluetooth application architecture (Page 327)
  - 6.1 Bluetooth profiles (Page 327)
  - 6.2 Generic Access Profile (Page 327)
  - 6.3 Profile hierarchy (Page 328)
  - 6.4 Generic Attribute Architecture (Page 329)
    - 6.4.1 Attribute Protocol (Page 329)
    - 6.4.2 Generic Attribute Profile (Page 329)
  - 6.5 GATT-Based Profile hierarchy (Page 330)
    - 6.5.1 Service (Page 331)
    - 6.5.2 Included services (Page 332)
    - 6.5.3 Characteristic (Page 332)
  - 6.6 [This section is no longer used] (Page 332)
- 7 Coexistence and collocation (Page 333)
  - 7.1 Core features supporting coexistence and collocation (Page 333)
  - 7.2 Adaptive Frequency Hopping (Page 334)
  - 7.3 Coexistence between Bluetooth Devices and Wireless LAN Devices (Page 335)
  - 7.4 Mobile Wireless Standards (MWS) coexistence (Page 335)
  - 7.5 Synchronizing Bluetooth with an external timing source (Page 338)
  - 7.6 Piconet clock adjustment (Page 339)
  - 7.7 Slot Availability Mask (SAM) (Page 340)
- 8 Direction finding using Bluetooth Low Energy (Page 341)
  - 8.1 Angle of arrival (AoA) method (Page 341)
  - 8.2 Angle of departure (AoD) method (Page 342)
- 9 Channel Sounding using Bluetooth Low Energy (Page 345)
  - 9.1 Channel Sounding procedure (Page 345)
  - 9.2 Distance estimation based on phase and amplitude information (Page 346)
  - 9.3 Distance estimation based on RTT packets (Page 348)
  - 9.4 Security features (Page 349)
